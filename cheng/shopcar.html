<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>购物车</title>
    <!--强制让文档的宽度与设备的宽度保持1:1，并且文档最大的宽度比例是1.0，且不允许用户点击屏幕放大浏览-->
    <meta name="viewport" content="initial-scale=1, width=device-width, maximum-scale=1, user-scalable=no"/>
    <!--WebApp全屏模式   隐藏地址栏-->
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <!--苹果强制全屏显示-->
    <meta name="apple-touch-fullscreen" content="yes"/>
    <!--强制全屏显示-->
    <meta name="full-screen" content="yes"/>
    <!--制定iphone中safari顶端的状态条的样式（default:白色，black:黑色，black-translucent：半透明）-->
    <meta name="apple-mobile-web-app-status-bar-style" content="black"/>
    <!--告诉设备忽略将页面中的数字识别为电话号码 -->
    <meta name="format-detection" content="telephone=no"/>
    <!--告诉设备忽略将页面中的地址识别 -->
    <meta name="format-detection" content="address=no"/>
    <link rel="stylesheet" href="css/shopcar.css">
</head>
<body>
<header>购物车</header>
<div class="mode_box">
    <div class="mode_msg">
        <span>
            <em></em>
            <span class="msg-safe">您正在安全购物环境中，请放心购物</span>
        </span>
    </div>
</div>
<div class="shop_title">
    <input type="checkbox" class="Qx">
    <span>JD京东自营</span>
    <i></i>
</div>
<div class="shop_tip"><span>超过50kg不免运费</span></div>
<div class="itemlist">
    <div class="item1">
        <input class="input1" type="checkbox">
        <img src="images/5677aa6dN0c425907.jpg!q70.jpg" alt="">
        <div class="item_detail">
            <div class="detail1">
                <span>金装婴儿配方奶粉 1段（0-6个月婴儿适用）400克</span>
                <i>重量:0.54kg 段位:美素1段400克</i>
            </div>
            <div class="price">
                <span class="pri">￥109.00</span>
                <span class="jian">-</span>
                <input type="text" value="1"/>
                <span class="add">+</span>
                <div class="Spri" style="display: none"></div>
            </div>
        </div>
    </div>

    <div class="item1">
        <input class="input1" type="checkbox">
        <img src="images/57d0d400Nfd249af4.jpg!q70.jpg" alt="">
        <div class="item_detail">
            <div class="detail1">
                <span>Apple iPhone 7 (A1660) 128G 黑色</span>
                <i>重量:0.39kg版本:iPhone 7</i>
            </div>
            <div class="price">
                <span class="pri">￥109.00</span>
                <span class="jian">-</span>
                <input type="text" value="1"/>
                <span class="add">+</span>
                <div class="Spri" style="display: none"></div>
            </div>
        </div>
    </div>

    <div class="item1">
        <input class="input1" type="checkbox">
        <img src="images/57d0d400Nfd249af4.jpg!q70.jpg" alt="">
        <div class="item_detail">
            <div class="detail1">
                <span>Apple iPhone 7 (A1660) 128G 黑色</span>
                <i>重量:0.39kg版本:iPhone 7</i>
            </div>
            <div class="price">
                <span class="pri">￥109.00</span>
                <span class="jian">-</span>
                <input type="text" value="1"/>
                <span class="add">+</span>
                <div class="Spri" style="display: none"></div>
            </div>
        </div>
    </div>

    <div class="item1">
        <input class="input1" type="checkbox">
        <img src="images/57d0d400Nfd249af4.jpg!q70.jpg" alt="">
        <div class="item_detail">
            <div class="detail1">
                <span>Apple iPhone 7 (A1660) 128G 黑色</span>
                <i>重量:0.39kg版本:iPhone 7</i>
            </div>
            <div class="price">
                <span class="pri">￥109.00</span>
                <span class="jian">-</span>
                <input type="text" value="1"/>
                <span class="add">+</span>
                <div class="Spri" style="display: none"></div>
            </div>
        </div>
    </div>

    <div class="item1">
        <input class="input1" type="checkbox">
        <img src="images/rBEhVlHnU9EIAAAAAAE2r4wpw1oAABI_gJYRrIAATbH261.jpg!q70.jpg" alt="">
        <div class="item_detail">
            <div class="detail1">
                <span>Apple iPhone 7 (A1660) 128G 黑色</span>
                <i>重量:0.39kg版本:iPhone 7</i>
            </div>
            <div class="price">
                <span class="pri">￥109.00</span>
                <span class="jian">-</span>
                <input type="text" value="1"/>
                <span class="add">+</span>
                <div class="Spri" style="display: none"></div>
            </div>
        </div>
    </div>
    <div class="item1">
        <input class="input1" type="checkbox">
        <img src="images/57d0d400Nfd249af4.jpg!q70.jpg" alt="">
        <div class="item_detail">
            <div class="detail1">
                <span>Apple iPhone 7 (A1660) 128G 黑色</span>
                <i>重量:0.39kg版本:iPhone 7</i>
            </div>
            <div class="price">
                <span class="pri">￥109.00</span>
                <span class="jian">-</span>
                <input type="text" value="1"/>
                <span class="add">+</span>
                <div class="Spri" style="display: none"></div>
            </div>
        </div>
    </div>
</div>
<div class="h"></div>
<footer>
    <input type="checkbox" class="Qx">
    <span></span>
    <div class="btn">

    </div>
</footer>
</body>
<script src="js/jquery-1.8.3.min.js"></script>
<script>
    $(function () {

        $(".Spri").html($(".Spri").siblings(".pri").html().substring(1))
        $(".add").click(function () {
            var index = $(".add").index(this);
            var nowText = $(".add").eq(index).siblings("input").val();
            var oPic = $(".add").eq(index).siblings(".pri").html().substring(1)
            nowText++;
            $(".add").eq(index).siblings(".Spri").html(oPic * nowText)
            $(".add").eq(index).siblings("input").val(nowText);
            SUM()
        })
        $(".jian").click(function () {
            var index = $(".jian").index(this);
            var nowTextJ = $(".jian").eq(index).siblings("input").val();
            nowTextJ--;
            if (nowTextJ <= 0) {
                nowTextJ = 0;
            }
            var oPic = $(".jian").eq(index).siblings(".pri").html().substring(1)
            $(".jian").eq(index).siblings(".Spri").html(oPic * nowTextJ)
            $(".jian").eq(index).siblings("input").val(nowTextJ)
            SUM()
        });
        SUM()
        function SUM() {
            var sum = 0;
            var pSum = 0;
            for (var i = 0; i < $(".input1:checked").length; i++) {
                sum = sum + parseInt($(".input1:checked").eq(i).siblings().find("input").val())
                pSum = pSum + parseInt($(".input1:checked").eq(i).siblings().find(".Spri").html())
            }
            $("footer .btn").html("去结算(" + sum + ")")
            $("footer span").html("总金额:￥" + pSum)
        }


        $(".Qx").click(function () {

            var state = $(".Qx").is(':checked');
            if (state) {
                $(".input1").each(function (index) {
                    $(this).attr("checked", true);
                    SUM()
                })
            } else {
                $(".input1").attr("checked", false);
                SUM()
            }
        });
        $(".input1").each(function () {
            $(this).click(function () {
                fun();
                if ($(this).is(':checked') == false) {
                    $(".Qx").attr("checked", false);
                }
                SUM()

            })

        })
        function fun() {
            var allLength = $(".input1").length;
            $(".input1").each(function () {
                $(this).bind('click', function () {
                    var aL = $(".input1:checked").length;
                    if (allLength == aL) {
                        $(".Qx").attr("checked", true);
                    }
                })
            })
        }

    })
</script>
</html>